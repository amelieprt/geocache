<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Connexion</title>
</head>

<body>
    <h1>Connexion</h1>
    <form id="loginForm" action="/login" method="POST">
        <label for="username">Nom d'utilisateur:</label>
        <input type="text" id="username" name="username" value="amelieprt" required><br><br>
        <label for="password">Mot de passe:</label>
        <input type="password" id="password" name="password" value="123" required><br><br>
        <button type="submit" tabindex="2">Se connecter</button>
    </form>
    <div id="message"></div>
    <script>
        document.getElementById('loginForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ username, password })
            })
                .then(response => {
                    const token = response.headers.get("token"); 
                    console.log("token", token)
                    return response.text();
                }
                ) // ðŸ”¥ Convertit la rÃ©ponse en texte
                .then(data => {
                    console.log(data);
                    document.write(data)
                 })
                 
                // .then(data => {
                //     if (data.token) {
                //         localStorage.setItem('token', data.token);
                //         window.location.href = '/read-cachette';
                //     } else {
                //         console.error('Connexion Ã©chouÃ©e');
                //     }
                // })
                .catch(error => console.error('Erreur:', error));
        });
    </script>
</body>

</html>